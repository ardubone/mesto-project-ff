(()=>{"use strict";var t={d:(e,n)=>{for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};t.d({},{vK:()=>V,fT:()=>I});var e,n=function(t){t.classList.toggle("popup_is-opened"),document.addEventListener("keydown",r)},o=function(t){t.classList.toggle("popup_is-opened"),document.removeEventListener("keydown",r)},r=function(t){"Escape"===t.key&&o(document.querySelector(".popup_is-opened"))},c="https://nomoreparties.co/v1/wff-cohort-5",u="123d08a2-0a99-4696-a359-e7de203515b4",a="".concat(c,"/cards"),i="".concat(c,"/cards/likes/"),l="".concat(c,"/users/me/avatar/"),p="".concat(c,"/users/me"),s=function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))},d=document.querySelector("#card-template").content,f=function(t,o,r){var c=d.querySelector(".card").cloneNode(!0),a=c.querySelector(".card__image"),l=c.querySelector(".card__title"),p=c.querySelector(".card__delete-button"),f=c.querySelector(".card__like-button"),_=c.querySelector(".card__like-counter");return a.src=t.link,l.textContent=t.name,a.alt=t.name,_.textContent=Object.keys(t.likes).length,a.dataset.id=t._id,p.addEventListener("click",(function(){e=t,n(I)})),f.addEventListener("click",(function(){var e;f.classList.contains("card__like-button_is-active")?(m(t),function(t){return fetch("".concat(i,"/").concat(t),{method:"DELETE",headers:{authorization:u}}).then(s)}(t._id).then((function(t){_.textContent=t.likes.length})).catch((function(t){V(t)}))):(m(t),(e=t._id,fetch("".concat(i,"/").concat(e),{method:"PUT",headers:{authorization:u}}).then(s)).then((function(t){_.textContent=t.likes.length})).catch((function(t){V(t)})))})),y(o,t,p),function(t,e,n){(function(t,e){return t.likes.some((function(t){return t._id===e._id}))})(t,e)&&n.classList.add("card__like-button_is-active")}(t,o,f),a.addEventListener("click",(function(){r(t)})),t.element=c,c},m=function(t){t.element.querySelector(".card__like-button").classList.toggle("card__like-button_is-active")},y=function(t,e,n){t._id!==e.owner._id&&n.remove()},_=/^[a-zA-Zа-яА-Я\s-]*$/;function v(t){return".".concat(t,"-error")}var h=function(t,e,n,o){var r=v(e.id),c=t.querySelector(r);e.classList.add(o.inputErrorClass),c.textContent=n},b=function(t,e,n){var o=v(e.id),r=t.querySelector(o);e.classList.remove(n.inputErrorClass),r.textContent=""};function S(t,e,n){return e.validity.valid?"url"===e.type||_.test(e.value)?(b(t,e,n),!0):(h(t,e,"Разрешены только латинские, кириллические буквы, знаки дефиса и пробелы",n),!1):(h(t,e,e.validationMessage,n),!1)}var E=function(t,e){var n=Array.from(t.querySelectorAll(e.popupInput)),o=t.querySelector(e.popupButton);n.forEach((function(r){r.addEventListener("input",(function(){S(t,r,e),function(t,e,n){!function(t,e){return!t.every((function(t){return S(t.parentElement,t,e)}))}(t,n)?e.classList.remove(n.popupButtonDisabled):e.classList.add(n.popupButtonDisabled)}(n,o,e)}))}))};function k(t,e){t.querySelectorAll(e.popupInput).forEach((function(n){b(t,n,e)})),function(t,e){t.querySelector(e.popupButton).classList.add(e.popupButtonDisabled)}(t,e)}function q(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,o=new Array(e);n<e;n++)o[n]=t[n];return o}var L,g=document.querySelector(".profile__image"),C=document.querySelector(".profile__edit-button"),x=document.querySelector(".popup_type_edit"),A=document.querySelector(".places__list"),j=document.querySelector(".profile__add-button"),w=document.querySelector(".popup_type_new-card"),O=document.querySelectorAll(".popup__close"),D=document.querySelector(".popup_type_avatar"),T=document.forms.edit_avatar,z=T.elements.avatar,I=document.querySelector(".popup_type_delete"),P=document.forms.delete,B=document.forms.edit_profile,N=B.elements.name,J=B.elements.description,F=document.querySelectorAll(".popup"),H=document.querySelector(".profile__title"),M=document.querySelector(".profile__description"),U=document.forms.new_place,$=U.elements.place_name,K=U.elements.link,Z=document.querySelector(".popup_type_image"),G=Z.querySelector(".popup__image"),Q=Z.querySelector(".popup__caption"),R={inputErrorClass:"popup__input_type_error",popupButtonDisabled:"popup__button_disabled",popupInput:".popup__input",popupButton:".popup__button",popupForm:".popup",popupErrortext:".popup__error-text"};function V(t){console.error("Ошибка:",t)}function W(t,e){e.querySelector(".popup__button").textContent=t?"Сохранение...":"Сохранить"}function X(t){G.src=t.link,G.alt=t.name,Q.textContent=t.name,n(Z)}function Y(t){M.textContent=t.about,H.textContent=t.name,g.style.backgroundImage="url('".concat(t.avatar,"')")}F.forEach((function(t){t.classList.contains("popup_is-animated")||t.classList.add("popup_is-animated")})),g.addEventListener("click",(function(){n(D),k(D,R)})),C.addEventListener("click",(function(){n(x),N.value=H.textContent,J.value=M.textContent,k(x,R)})),j.addEventListener("click",(function(){n(w),k(w,R)})),O.forEach((function(t){var e=t.closest(".popup");t.addEventListener("click",(function(){return o(e)}))})),F.forEach((function(t){t.addEventListener("click",(function(e){e.target===t&&o(t)}))})),P.addEventListener("submit",(function(t){var n;t.preventDefault(),(n=e._id,fetch("".concat(a,"/").concat(n),{method:"DELETE",headers:{authorization:u}}).then(s)).then((function(){e.element.remove(),o(I)})).catch((function(t){V(t)}))})),T.addEventListener("submit",(function(t){t.preventDefault(),W(!0,D),function(t){return fetch(l,{method:"PATCH",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({avatar:t})}).then(s)}(z=T.elements.avatar.value).then((function(){g.style.backgroundImage="url('".concat(z,"')"),T.reset(),o(D)})).catch((function(t){V(t)})).finally((function(){W(!1,D)}))})),B.addEventListener("submit",(function(t){var e,n;t.preventDefault(),W(!0,x),(e=N.value,n=J.value,fetch(p,{method:"PATCH",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({name:e,about:n})}).then(s)).then((function(t){Y(t),H.textContent=N.value,M.textContent=J.value,o(x)})).catch((function(t){V(t)})).finally((function(){W(!1,x)}))})),U.addEventListener("submit",(function(t){t.preventDefault(),W(!0,w);var e,n,r={name:$.value,link:K.value};(e=r.name,n=r.link,fetch(a,{method:"POST",headers:{authorization:u,"Content-Type":"application/json"},body:JSON.stringify({name:e,link:n})}).then(s)).then((function(t){A.prepend(f(t,t.owner,X)),U.reset(),o(w)})).catch((function(t){V(t)})).finally((function(){W(!1,w)}))})),L=R,Array.from(document.querySelectorAll(L.popupForm)).forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault()})),E(t,L)})),Promise.all([fetch(p,{headers:{authorization:u}}).then(s),fetch(a,{headers:{authorization:u}}).then(s)]).then((function(t){var e,n,o=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var o,r,c,u,a=[],i=!0,l=!1;try{if(c=(n=n.call(t)).next,0===e){if(Object(n)!==n)return;i=!1}else for(;!(i=(o=c.call(n)).done)&&(a.push(o.value),a.length!==e);i=!0);}catch(t){l=!0,r=t}finally{try{if(!i&&null!=n.return&&(u=n.return(),Object(u)!==u))return}finally{if(l)throw r}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return q(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);return"Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?q(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),r=o[0];!function(t,e){e.forEach((function(e){var n=f(e,t,X);A.append(n)}))}(r,o[1]),Y(r)})).catch((function(t){V(t)}))})();